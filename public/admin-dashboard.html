<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel — Harshith Portfolio</title>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link
        href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800&family=Inter:wght@300;400;500;600&display=swap"
        rel="stylesheet">
    <style>
        :root {
            --primary: #FF4D8D;
            --primary-glow: rgba(255, 77, 141, 0.3);
            --secondary: #7C3AED;
            --accent: #00D4FF;
            --bg-dark: #070A12;
            --bg-surface: #0F172A;
            --bg-card: rgba(30, 41, 59, 0.7);
            --text-main: #F1F5F9;
            --text-muted: #94A3B8;
            --border: rgba(255, 255, 255, 0.1);
            --radius-lg: 24px;
            --radius-md: 14px;
            --shadow-lg: 0 20px 50px rgba(0, 0, 0, 0.5);
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', sans-serif;
        }

        h1,
        h2,
        h3,
        h4,
        .btn,
        .nav-item,
        .logo-text {
            font-family: 'Outfit', sans-serif;
        }

        body {
            background-color: var(--bg-dark);
            color: var(--text-main);
            min-height: 100vh;
            overflow-x: hidden;
            display: flex;
        }

        /* Ambient Background */
        .ambient-bg {
            position: fixed;
            inset: 0;
            z-index: -1;
            pointer-events: none;
            overflow: hidden;
        }

        .blob {
            position: absolute;
            width: 600px;
            height: 600px;
            border-radius: 50%;
            filter: blur(120px);
            opacity: 0.12;
            animation: move 25s infinite alternate;
        }

        .blob-1 {
            background: var(--primary);
            top: -10%;
            left: -10%;
        }

        .blob-2 {
            background: var(--secondary);
            bottom: -10%;
            right: -10%;
            animation-delay: -7s;
        }

        .blob-3 {
            background: var(--accent);
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            animation-delay: -12s;
        }

        @keyframes move {
            0% {
                transform: translate(0, 0) rotate(0deg) scale(1);
            }

            100% {
                transform: translate(120px, 80px) rotate(90deg) scale(1.15);
            }
        }

        /* Sidebar */
        .sidebar {
            width: 280px;
            background: rgba(15, 23, 42, 0.85);
            backdrop-filter: blur(30px);
            border-right: 1px solid var(--border);
            padding: 40px 20px;
            display: flex;
            flex-direction: column;
            position: fixed;
            height: 100vh;
            z-index: 100;
        }

        .logo-area {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 50px;
            padding: 0 10px;
        }

        .logo-circle {
            width: 44px;
            height: 44px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 8px 16px var(--primary-glow);
        }

        .logo-text {
            font-size: 22px;
            font-weight: 800;
            letter-spacing: -0.5px;
            background: linear-gradient(to right, #fff, #94A3B8);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .nav-menu {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .nav-item {
            padding: 15px 20px;
            border-radius: 16px;
            color: var(--text-muted);
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 15px;
            cursor: pointer;
            transition: var(--transition);
            font-size: 15px;
            font-weight: 500;
        }

        .nav-item i {
            font-size: 19px;
            width: 24px;
            text-align: center;
        }

        .nav-item:hover {
            color: white;
            background: rgba(255, 255, 255, 0.04);
            transform: translateX(4px);
        }

        .nav-item.active {
            background: rgba(255, 77, 141, 0.12);
            color: var(--primary);
            box-shadow: inset 0 0 0 1px var(--primary-glow);
        }

        .sidebar-footer {
            margin-top: auto;
        }

        .logout-btn {
            width: 100%;
            padding: 15px;
            background: rgba(239, 68, 68, 0.1);
            color: #ef4444;
            border: 1px solid rgba(239, 68, 68, 0.2);
            border-radius: 16px;
            cursor: pointer;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            transition: var(--transition);
        }

        .logout-btn:hover {
            background: #ef4444;
            color: white;
            box-shadow: 0 8px 20px rgba(239, 68, 68, 0.3);
        }

        /* Main Content */
        .main-content {
            flex: 1;
            margin-left: 280px;
            padding: 50px;
            max-width: 1300px;
        }

        .header {
            margin-bottom: 50px;
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
            position: relative;
        }

        .header h1 {
            font-size: 36px;
            font-weight: 800;
            margin-bottom: 8px;
            background: linear-gradient(to right, #fff, #94A3B8);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .header p {
            color: var(--text-muted);
            font-size: 16px;
        }

        .section {
            display: none;
            animation: slideUp 0.6s cubic-bezier(0.16, 1, 0.3, 1) backwards;
        }

        .section.active {
            display: block;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Cards */
        .card {
            background: var(--bg-card);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border);
            border-radius: var(--radius-lg);
            padding: 35px;
            margin-bottom: 30px;
            box-shadow: var(--shadow-lg);
            position: relative;
            overflow: hidden;
        }

        .card::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 1px;
            background: linear-gradient(90deg, transparent, var(--border), transparent);
        }

        .card-title {
            font-size: 22px;
            font-weight: 700;
            margin-bottom: 30px;
            display: flex;
            align-items: center;
            gap: 15px;
            color: var(--primary);
        }

        /* Form Controls */
        .form-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 25px;
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            margin-bottom: 12px;
            font-size: 12px;
            font-weight: 700;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 1.5px;
        }

        .form-control {
            width: 100%;
            background: rgba(2, 6, 23, 0.5);
            border: 1px solid var(--border);
            border-radius: var(--radius-md);
            padding: 16px 20px;
            color: white;
            font-size: 15px;
            transition: var(--transition);
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary);
            background: rgba(2, 6, 23, 0.7);
            box-shadow: 0 0 0 4px var(--primary-glow);
        }

        textarea.form-control {
            min-height: 140px;
            line-height: 1.7;
        }

        /* Buttons */
        .btn {
            padding: 16px 32px;
            border-radius: var(--radius-md);
            font-weight: 700;
            font-size: 15px;
            cursor: pointer;
            transition: var(--transition);
            border: none;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), #ff6a9f);
            color: white;
            box-shadow: 0 12px 24px var(--primary-glow);
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 18px 36px var(--primary-glow);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.05);
            color: white;
            border: 1px solid var(--border);
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.08);
            border-color: rgba(255, 255, 255, 0.2);
        }

        /* List Items */
        .list-container {
            display: grid;
            gap: 18px;
        }

        .list-item {
            background: rgba(2, 6, 23, 0.4);
            border: 1px solid var(--border);
            border-radius: 20px;
            padding: 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: var(--transition);
        }

        .list-item:hover {
            border-color: rgba(255, 77, 141, 0.4);
            background: rgba(2, 6, 23, 0.6);
            transform: scale(1.01);
        }

        .item-info h4 {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 8px;
            color: #fff;
        }

        .item-info p {
            font-size: 14px;
            color: var(--text-muted);
            line-height: 1.5;
        }

        .item-tags {
            margin-top: 15px;
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .tag {
            padding: 5px 12px;
            background: rgba(0, 212, 255, 0.1);
            color: var(--accent);
            border-radius: 8px;
            font-size: 11px;
            font-weight: 800;
            text-transform: uppercase;
        }

        .item-actions {
            display: flex;
            gap: 12px;
        }

        .action-btn {
            width: 44px;
            height: 44px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
            border: 1px solid var(--border);
            font-size: 16px;
        }

        .edit-btn {
            background: rgba(124, 58, 237, 0.1);
            color: #a78bfa;
        }

        .edit-btn:hover {
            background: var(--secondary);
            color: white;
            border-color: var(--secondary);
        }

        .delete-btn {
            background: rgba(239, 68, 68, 0.1);
            color: #f87171;
        }

        .delete-btn:hover {
            background: #ef4444;
            color: white;
            border-color: #ef4444;
        }

        /* File Upload System */
        .upload-section {
            display: flex;
            flex-direction: column;
            gap: 30px;
            align-items: center;
        }

        .avatar-container {
            position: relative;
            width: 160px;
            height: 160px;
        }

        .avatar-circle {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            border: 3px solid var(--border);
            padding: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            background: var(--bg-surface);
            transition: var(--transition);
        }

        .avatar-circle img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 50%;
        }

        .avatar-circle i {
            font-size: 60px;
            color: var(--border);
        }

        .avatar-edit-btn {
            position: absolute;
            bottom: 5px;
            right: 5px;
            width: 44px;
            height: 44px;
            background: var(--primary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(255, 77, 141, 0.4);
            border: 3px solid var(--bg-card);
            transition: var(--transition);
        }

        .avatar-edit-btn:hover {
            transform: scale(1.1);
        }

        .doc-upload-grid {
            width: 100%;
            display: grid;
            gap: 20px;
        }

        .doc-card {
            background: rgba(2, 6, 23, 0.4);
            border: 1px solid var(--border);
            border-radius: 18px;
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 20px;
            cursor: pointer;
            transition: var(--transition);
        }

        .doc-card:hover {
            border-color: var(--primary);
            background: rgba(2, 6, 23, 0.6);
        }

        .doc-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }

        /* Modal */
        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(12px);
            z-index: 1000;
            display: none;
            align-items: center;
            justify-content: center;
            padding: 25px;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal-container {
            background: var(--bg-surface);
            border: 1px solid var(--border);
            border-radius: 30px;
            width: 100%;
            max-width: 680px;
            max-height: 85vh;
            overflow-y: auto;
            position: relative;
            box-shadow: 0 50px 100px rgba(0, 0, 0, 0.8);
            animation: modalIn 0.4s cubic-bezier(0.16, 1, 0.3, 1);
        }

        @keyframes modalIn {
            from {
                opacity: 0;
                transform: scale(0.95) translateY(30px);
            }

            to {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }

        .modal-header {
            padding: 30px 40px;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-body {
            padding: 40px;
        }

        .modal-footer {
            padding: 30px 40px;
            border-top: 1px solid var(--border);
            display: flex;
            justify-content: flex-end;
            gap: 15px;
        }

        /* Access System */
        .login-overlay {
            position: fixed;
            inset: 0;
            background: var(--bg-dark);
            z-index: 3000;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .login-card {
            width: 100%;
            max-width: 440px;
            padding: 60px;
            background: var(--bg-surface);
            border-radius: 40px;
            border: 1px solid var(--border);
            box-shadow: 0 40px 120px rgba(0, 0, 0, 0.7);
            text-align: center;
        }

        /* Toast Notifications */
        .toast {
            position: fixed;
            bottom: 40px;
            right: 40px;
            padding: 20px 30px;
            border-radius: 18px;
            background: #10B981;
            color: white;
            font-weight: 700;
            box-shadow: 0 15px 40px rgba(16, 185, 129, 0.3);
            display: none;
            z-index: 9999;
            animation: toastSlide 0.4s cubic-bezier(0.16, 1, 0.3, 1);
        }

        @keyframes toastSlide {
            from {
                transform: translateX(50px);
                opacity: 0;
            }

            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .toast.error {
            background: #ef4444;
            box-shadow: 0 15px 40px rgba(239, 68, 68, 0.3);
        }

        @media (max-width: 1000px) {
            .sidebar {
                width: 90px;
                padding: 40px 15px;
            }

            .logo-text,
            .nav-item span {
                display: none;
            }

            .nav-item {
                justify-content: center;
                border-radius: 18px;
            }

            .main-content {
                margin-left: 90px;
                padding: 40px;
            }

            .form-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>

<body>
    <div class="ambient-bg">
        <div class="blob blob-1"></div>
        <div class="blob blob-2"></div>
        <div class="blob blob-3"></div>
    </div>

    <!-- Security Gate -->
    <div id="loginOverlay" class="login-overlay">
        <div class="login-card">
            <div class="logo-area" style="justify-content: center; margin-bottom: 40px;">
                <div class="logo-circle"><i class="fas fa-fingerprint" style="color: white; font-size: 20px;"></i></div>
                <div class="logo-text" style="-webkit-text-fill-color: white;">SECURE CORE</div>
            </div>
            <h2 style="font-size: 32px; margin-bottom: 12px; font-weight: 800;">Command Center</h2>
            <p style="margin-bottom: 40px;">Authenticate to modify portfolio datasets</p>
            <form id="loginForm">
                <div class="form-group" style="text-align: left;">
                    <label>ACCESS ID</label>
                    <input type="text" id="username" class="form-control" placeholder="admin" required
                        autocomplete="username">
                </div>
                <div class="form-group" style="text-align: left;">
                    <label>SECURITY KEY</label>
                    <input type="password" id="password" class="form-control" placeholder="••••••••" required
                        autocomplete="current-password">
                </div>
                <button type="submit" class="btn btn-primary" style="width: 100%; margin-top: 15px;">
                    <i class="fas fa-unlock"></i> INITIALIZE SESSION
                </button>
            </form>
        </div>
    </div>

    <!-- Navigation Sidebar -->
    <div id="sidebar" class="sidebar" style="display: none;">
        <div class="logo-area">
            <div class="logo-circle"><i class="fas fa-meteor" style="color: white; font-size: 20px;"></i></div>
            <div class="logo-text">HYPERCORE</div>
        </div>

        <div class="nav-menu">
            <div class="nav-item active" onclick="switchTab('profile')">
                <i class="fas fa-sliders"></i> <span>Identity System</span>
            </div>
            <div class="nav-item" onclick="switchTab('skills')">
                <i class="fas fa-layer-group"></i> <span>Tech Ecosystem</span>
            </div>
            <div class="nav-item" onclick="switchTab('projects')">
                <i class="fas fa-cubes"></i> <span>Project Lab</span>
            </div>
            <div class="nav-item" onclick="switchTab('certificates')">
                <i class="fas fa-shield-check"></i> <span>Verified Links</span>
            </div>
            <div class="nav-item" onclick="switchTab('achievements')">
                <i class="fas fa-star"></i> <span>Milestones</span>
            </div>
        </div>

        <div class="sidebar-footer">
            <button class="logout-btn" onclick="logout()">
                <i class="fas fa-sign-out-alt"></i> <span>TERMINATE</span>
            </button>
        </div>
    </div>

    <!-- Main Viewport -->
    <div id="mainContent" class="main-content" style="display: none;">
        <div class="header">
            <div>
                <p id="currentTime">Syncing status...</p>
                <h1 id="welcomeHeader">System Manager</h1>
            </div>
            <div style="text-align: right;">
                <p style="font-weight:700; color:var(--accent);">ENCRYPTED CONNECTION</p>
                <p id="statsInfo" style="font-size:13px;">All engines normal</p>
            </div>
        </div>

        <!-- Feedback Layer -->
        <div id="toast" class="toast">Operation Successful</div>

        <!-- IDENTITY CONTROL -->
        <div id="profile" class="section active">
            <div class="form-grid">
                <div class="card">
                    <h3 class="card-title"><i class="fas fa-address-card"></i> Core Identity</h3>
                    <form id="profileForm">
                        <div class="form-group">
                            <label>Legal / Display Name</label>
                            <input type="text" id="profileName" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label>Professional Status Line</label>
                            <input type="text" id="profileTagline" class="form-control"
                                placeholder="e.g. MERN Stack Architect">
                        </div>
                        <div class="form-group">
                            <label>Biography & Background</label>
                            <textarea id="profileAbout" class="form-control"></textarea>
                        </div>
                        <div class="form-grid">
                            <div class="form-group">
                                <label>Contact Email</label>
                                <input type="text" id="profileEmail" class="form-control" required>
                            </div>
                            <div class="form-group">
                                <label>Phone ID</label>
                                <input type="text" id="profilePhone" class="form-control" placeholder="+91 ...">
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Current Location Node</label>
                            <input type="text" id="profileLocation" class="form-control">
                        </div>

                        <h3 class="card-title" style="margin-top: 30px;"><i class="fas fa-link"></i> External Nodes</h3>
                        <div class="form-grid">
                            <div class="form-group">
                                <label><i class="fab fa-github"></i> GitHub</label>
                                <input type="text" id="socialGithub" class="form-control" placeholder="URL">
                            </div>
                            <div class="form-group">
                                <label><i class="fab fa-linkedin"></i> LinkedIn</label>
                                <input type="text" id="socialLinkedin" class="form-control" placeholder="URL">
                            </div>
                        </div>
                        <div class="form-grid">
                            <div class="form-group">
                                <label><i class="fab fa-twitter"></i> Twitter / X</label>
                                <input type="text" id="socialTwitter" class="form-control" placeholder="URL">
                            </div>
                            <div class="form-group">
                                <label><i class="fas fa-globe"></i> Global Portfolio</label>
                                <input type="text" id="socialPortfolio" class="form-control" placeholder="URL">
                            </div>
                        </div>

                        <button type="submit" class="btn btn-primary" style="margin-top: 15px; width: 100%;">
                            <i class="fas fa-sync"></i> COMMIT DATABASE CHANGES
                        </button>
                    </form>
                </div>

                <div class="card">
                    <h3 class="card-title"><i class="fas fa-cloud-bolt"></i> Object Storage</h3>
                    <div class="upload-section">
                        <div class="avatar-container">
                            <div class="avatar-circle" id="imagePreview">
                                <i class="fas fa-user-astronaut"></i>
                            </div>
                            <div class="avatar-edit-btn" onclick="document.getElementById('profileImageInput').click()">
                                <i class="fas fa-camera"></i>
                            </div>
                        </div>
                        <input type="file" id="profileImageInput" accept="image/*" style="display: none;"
                            onchange="uploadFile('profileImage')">

                        <div class="doc-upload-grid">
                            <label
                                style="font-size:11px; font-weight:800; color:var(--text-muted); text-align:center;">MANIFESTS
                                & DOCUMENTS</label>

                            <div class="doc-card" onclick="document.getElementById('resumeInput').click()">
                                <div class="doc-icon" style="background: rgba(239, 68, 68, 0.15); color: #ef4444;">
                                    <i class="fas fa-file-pdf"></i>
                                </div>
                                <div>
                                    <p style="font-weight:700; font-size:15px;">Primary Resume</p>
                                    <p style="font-size:12px; color:var(--text-muted);">Synchronize PDF data</p>
                                </div>
                                <input type="file" id="resumeInput" accept=".pdf" style="display: none;"
                                    onchange="uploadFile('resume')">
                            </div>

                            <div class="doc-card" onclick="document.getElementById('cvInput').click()">
                                <div class="doc-icon"
                                    style="background: rgba(0, 212, 255, 0.15); color: var(--accent);">
                                    <i class="fas fa-file-invoice"></i>
                                </div>
                                <div>
                                    <p style="font-weight:700; font-size:15px;">Professional CV</p>
                                    <p style="font-size:12px; color:var(--text-muted);">Synchronize PDF data</p>
                                </div>
                                <input type="file" id="cvInput" accept=".pdf" style="display: none;"
                                    onchange="uploadFile('cv')">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- DYNAMIC SECTIONS -->
        <div id="skills" class="section">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title" style="margin-bottom:0;"><i class="fas fa-layer-group"></i> Ecosystem Map
                    </h3>
                    <button class="btn btn-primary" onclick="openSkillModal()">
                        <i class="fas fa-plus"></i> NEW SECTOR
                    </button>
                </div>
                <div id="skillsList" class="list-container"></div>
            </div>
        </div>

        <div id="projects" class="section">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title" style="margin-bottom:0;"><i class="fas fa-cubes"></i> Project Inventory</h3>
                    <button class="btn btn-primary" onclick="openProjectModal()">
                        <i class="fas fa-plus"></i> NEW PROJECT
                    </button>
                </div>
                <div id="projectsList" class="list-container"></div>
            </div>
        </div>

        <div id="certificates" class="section">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title" style="margin-bottom:0;"><i class="fas fa-shield-check"></i> Verification
                        Vault</h3>
                    <button class="btn btn-primary" onclick="openCertModal()">
                        <i class="fas fa-plus"></i> NEW ENTRY
                    </button>
                </div>
                <div id="certificatesList" class="list-container"></div>
            </div>
        </div>

        <div id="achievements" class="section">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title" style="margin-bottom:0;"><i class="fas fa-star"></i> Timeline Records</h3>
                    <button class="btn btn-primary" onclick="openAchievementModal()">
                        <i class="fas fa-plus"></i> NEW MILESTONE
                    </button>
                </div>
                <div id="achievementsList" class="list-container"></div>
            </div>
        </div>
    </div>

    <!-- OVERLAY CONTROLS -->
    <div id="modalOverlay" class="modal-overlay">
        <div class="modal-container">
            <div class="modal-header">
                <h2 id="modalTitle">Configure Object</h2>
                <div class="modal-close" onclick="closeModal()"
                    style="cursor:pointer; font-size:24px; color:var(--text-muted);"><i class="fas fa-times"></i></div>
            </div>
            <form id="modalForm">
                <div class="modal-body" id="modalFields"></div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" onclick="closeModal()">ABORT</button>
                    <button type="submit" class="btn btn-primary">WRITE TO DB</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        const API_BASE = '/api';
        let token = localStorage.getItem('token'); // Keep token as let for assignment in handleLogin
        let currentPortfolio = null;

        // ========== INITIALIZATION ==============

        // Remove Login Page completely
        document.getElementById('loginOverlay').style.display = 'none';
        document.getElementById('sidebar').style.display = 'flex';
        document.getElementById('mainContent').style.display = 'block';

        initDashboard();

        /*
        // Check for token on load
        const token = localStorage.getItem('token');
        if (token) {
            initDashboard();
        }
        */

        async function handleLogin(e) {
            e.preventDefault();
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;

            try {
                const response = await fetch(`${API_BASE}/auth/login`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ username, password })
                });

                const data = await response.json();

                if (response.ok) {
                    token = data.token;
                    localStorage.setItem('token', token);
                    initDashboard();
                    showToast('SESSION INITIALIZED. WELCOME ADMIN.');
                } else {
                    showToast(data.error || 'ACCESS DENIED: INVALID KEY', 'error');
                }
            } catch (err) {
                showToast('CONNECTION TIMEOUT: SERVER OFFLINE', 'error');
            }
        }

        function initDashboard() {
            document.getElementById('loginOverlay').style.display = 'none';
            document.getElementById('sidebar').style.display = 'flex';
            document.getElementById('mainContent').style.display = 'block';

            // System Clock
            setInterval(() => {
                const now = new Date();
                document.getElementById('currentTime').textContent = now.toLocaleDateString('en-US', {
                    month: 'short', day: 'numeric', year: 'numeric'
                }) + ' | ' + now.toLocaleTimeString();
            }, 1000);

            loadPortfolioData();
            setupEventListeners();
        }

        function logout() {
            localStorage.removeItem('token');
            location.reload();
        }

        function setupEventListeners() {
            document.getElementById('loginForm').addEventListener('submit', handleLogin);
            document.getElementById('profileForm').addEventListener('submit', handleProfileUpdate);
        }

        // DB CONNECTIVITY
        async function loadPortfolioData() {
            try {
                const response = await fetch(`${API_BASE}/admin/portfolio`, {
                    headers: { 'Authorization': `Bearer ${token}` }
                });

                // if (response.status === 401) return logout();
                if (!response.ok) throw new Error();

                currentPortfolio = await response.json();
                renderUI();
            } catch (err) {
                showToast('DATA FETCH ERROR: DB NOT REACHABLE', 'error');
            }
        }

        function renderUI() {
            const p = currentPortfolio.profile;
            document.getElementById('welcomeHeader').textContent = `SYSTEM MANAGER: ${p.name.toUpperCase()}`;

            // Bind Fields
            document.getElementById('profileName').value = p.name || '';
            document.getElementById('profileTagline').value = p.tagline || '';
            document.getElementById('profileAbout').value = p.about || '';
            document.getElementById('profileEmail').value = p.email || '';
            document.getElementById('profilePhone').value = p.phone || '';
            document.getElementById('profileLocation').value = p.location || '';

            if (p.socials) {
                document.getElementById('socialGithub').value = p.socials.github || '';
                document.getElementById('socialLinkedin').value = p.socials.linkedin || '';
                document.getElementById('socialTwitter').value = p.socials.twitter || '';
                document.getElementById('socialPortfolio').value = p.socials.portfolio || '';
            }

            if (p.profileImage) {
                document.getElementById('imagePreview').innerHTML = `<img src="${p.profileImage}" alt="avatar">`;
            }

            // Sub-collections
            renderSkills();
            renderProjects();
            renderCertificates();
            renderAchievements();
        }

        // INTERFACE CONTROLS
        function switchTab(tabId) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.getElementById(tabId).classList.add('active');

            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            event.currentTarget.classList.add('active');
        }

        // CORE UPDATES
        async function handleProfileUpdate(e) {
            e.preventDefault();
            const profile = {
                name: document.getElementById('profileName').value,
                tagline: document.getElementById('profileTagline').value,
                about: document.getElementById('profileAbout').value,
                email: document.getElementById('profileEmail').value,
                phone: document.getElementById('profilePhone').value,
                location: document.getElementById('profileLocation').value,
                socials: {
                    github: document.getElementById('socialGithub').value,
                    linkedin: document.getElementById('socialLinkedin').value,
                    twitter: document.getElementById('socialTwitter').value,
                    portfolio: document.getElementById('socialPortfolio').value
                }
            };

            try {
                const res = await fetch(`${API_BASE}/admin/portfolio`, {
                    method: 'PUT',
                    headers: { 'Authorization': `Bearer ${token}`, 'Content-Type': 'application/json' },
                    body: JSON.stringify({ profile })
                });
                if (!res.ok) throw new Error();

                // Update local state and UI immediately
                currentPortfolio.profile = { ...currentPortfolio.profile, ...profile };
                showToast('DATABASE SYNCHRONIZED SUCCESSFULLY');
                renderUI();
            } catch (err) {
                showToast('COMMIT FAILED: PERMISSION ERROR', 'error');
            }
        }

        // BLOB STORAGE
        async function uploadFile(type) {
            const input = document.getElementById(`${type}Input`);
            const file = input.files[0];
            if (!file) return;

            const formData = new FormData();
            formData.append(type === 'profileImage' ? 'profileImage' : type, file);

            try {
                const res = await fetch(`${API_BASE}/admin/upload/${type === 'profileImage' ? 'profile-image' : type}`, {
                    method: 'POST',
                    headers: { 'Authorization': `Bearer ${token}` },
                    body: formData
                });
                if (!res.ok) throw new Error();
                showToast(`${type.toUpperCase()} TRANSMITTED SUCCESSFULLY`);
                loadPortfolioData();
            } catch (err) {
                showToast('UPLINK ERROR: FILE REJECTED', 'error');
            }
        }

        // MODAL ENGINE
        function openModal(title, fields, onSave) {
            const modal = document.getElementById('modalOverlay');
            const fieldsContainer = document.getElementById('modalFields');
            const form = document.getElementById('modalForm');

            document.getElementById('modalTitle').textContent = title;
            fieldsContainer.innerHTML = '';

            fields.forEach(f => {
                const group = document.createElement('div');
                group.className = 'form-group';
                group.innerHTML = `
                    <label>${f.label}</label>
                    ${f.type === 'textarea' ?
                        `<textarea id="m_${f.key}" class="form-control">${f.value || ''}</textarea>` :
                        `<input type="text" id="m_${f.key}" class="form-control" value="${f.value || ''}" placeholder="${f.placeholder || ''}">`
                    }
                `;
                fieldsContainer.appendChild(group);
            });

            form.onsubmit = async (e) => {
                e.preventDefault();
                const data = {};
                fields.forEach(f => data[f.key] = document.getElementById(`m_${f.key}`).value);
                await onSave(data);
                closeModal();
            };

            modal.classList.add('active');
        }

        function closeModal() {
            document.getElementById('modalOverlay').classList.remove('active');
        }

        // COMPONENT RENDERING
        function renderSkills() {
            const list = document.getElementById('skillsList');
            list.innerHTML = (currentPortfolio.skills || []).map(cat => `
                <div class="list-item">
                    <div class="item-info">
                        <h4>${cat.category}</h4>
                        <div class="item-tags">
                            ${(cat.items || []).map(i => `<span class="tag">${i}</span>`).join('')}
                        </div>
                    </div>
                    <div class="item-actions">
                        <div class="action-btn edit-btn" onclick="editSkill('${cat._id}')"><i class="fas fa-edit"></i></div>
                        <div class="action-btn delete-btn" onclick="deleteItem('skills', '${cat._id}')"><i class="fas fa-trash"></i></div>
                    </div>
                </div>
            `).join('');
        }

        function renderProjects() {
            const list = document.getElementById('projectsList');
            list.innerHTML = (currentPortfolio.projects || []).map(proj => `
                <div class="list-item">
                    <div class="item-info">
                        <h4>${proj.title}</h4>
                        <p>${proj.description.substring(0, 100)}...</p>
                        <div class="item-tags">
                            ${(proj.tags || []).map(t => `<span class="tag">${t}</span>`).join('')}
                        </div>
                    </div>
                    <div class="item-actions">
                        <div class="action-btn edit-btn" onclick="editProject('${proj._id}')"><i class="fas fa-edit"></i></div>
                        <div class="action-btn delete-btn" onclick="deleteItem('projects', '${proj._id}')"><i class="fas fa-trash"></i></div>
                    </div>
                </div>
            `).join('');
        }

        function renderCertificates() {
            const list = document.getElementById('certificatesList');
            list.innerHTML = (currentPortfolio.certificates || []).map(c => `
                <div class="list-item">
                    <div class="item-info">
                        <h4>${c.title}</h4>
                        <p>${c.issuer} | ${c.date || 'Active'}</p>
                    </div>
                    <div class="item-actions">
                        <div class="action-btn edit-btn" onclick="editCert('${c._id}')"><i class="fas fa-edit"></i></div>
                        <div class="action-btn delete-btn" onclick="deleteItem('certificates', '${c._id}')"><i class="fas fa-trash"></i></div>
                    </div>
                </div>
            `).join('');
        }

        function renderAchievements() {
            const list = document.getElementById('achievementsList');
            list.innerHTML = (currentPortfolio.achievements || []).map(a => `
                <div class="list-item">
                    <div class="item-info">
                        <h4>${a.title}</h4>
                        <p>${a.date} — ${a.detail.substring(0, 80)}...</p>
                    </div>
                    <div class="item-actions">
                        <div class="action-btn edit-btn" onclick="editAchievement('${a._id}')"><i class="fas fa-edit"></i></div>
                        <div class="action-btn delete-btn" onclick="deleteItem('achievements', '${a._id}')"><i class="fas fa-trash"></i></div>
                    </div>
                </div>
            `).join('');
        }

        // DESTRUCTION ENGINE
        async function deleteItem(type, id) {
            if (!confirm('PERMANENTLY REMOVE OBJECT FROM DATABASE?')) return;
            try {
                const res = await fetch(`${API_BASE}/admin/portfolio/${type}/${id}`, {
                    method: 'DELETE',
                    headers: { 'Authorization': `Bearer ${token}` }
                });
                if (!res.ok) throw new Error();

                // Update local state
                currentPortfolio[type] = currentPortfolio[type].filter(item => item._id !== id);
                showToast('OBJECT DELETED PERMANENTLY');

                // Re-render only the affected section
                if (type === 'skills') renderSkills();
                if (type === 'projects') renderProjects();
                if (type === 'certificates') renderCertificates();
                if (type === 'achievements') renderAchievements();
            } catch (err) { showToast('DELETE FAILED: PROTECTED OBJECT', 'error'); }
        }

        // SPECIFIC LOGIC
        function openSkillModal() {
            openModal('Sync Skill Sector', [
                { key: 'category', label: 'Sector Name', placeholder: 'e.g. Cloud Infrastructure' },
                { key: 'items', label: 'Node Comps (comma separated)', placeholder: 'AWS, Azure, GCP' }
            ], async (data) => {
                const res = await fetch(`${API_BASE}/admin/portfolio/skills`, {
                    method: 'POST',
                    headers: { 'Authorization': `Bearer ${token}`, 'Content-Type': 'application/json' },
                    body: JSON.stringify({ category: data.category, items: data.items.split(',').map(s => s.trim()) })
                });
                if (res.ok) {
                    const result = await res.json();
                    currentPortfolio.skills = result.skills;
                    renderSkills();
                    showToast('SKILL SECTOR ADDED');
                }
            });
        }

        function editSkill(id) {
            const s = currentPortfolio.skills.find(x => x._id === id);
            openModal('Modify Skill Sector', [
                { key: 'category', label: 'Sector Name', value: s.category },
                { key: 'items', label: 'Node Comps', value: s.items.join(', ') }
            ], async (data) => {
                const res = await fetch(`${API_BASE}/admin/portfolio/skills/${id}`, {
                    method: 'PUT',
                    headers: { 'Authorization': `Bearer ${token}`, 'Content-Type': 'application/json' },
                    body: JSON.stringify({ category: data.category, items: data.items.split(',').map(s => s.trim()) })
                });
                if (res.ok) {
                    const result = await res.json();
                    // Update local list
                    const idx = currentPortfolio.skills.findIndex(x => x._id === id);
                    currentPortfolio.skills[idx] = { ...currentPortfolio.skills[idx], category: data.category, items: data.items.split(',').map(s => s.trim()) };
                    renderSkills();
                    showToast('SKILL SECTOR UPDATED');
                }
            });
        }

        function openProjectModal() {
            openModal('Register New Project', [
                { key: 'title', label: 'Component Title' },
                { key: 'description', label: 'Technical Specification', type: 'textarea' },
                { key: 'tags', label: 'Tech Stack (comma separated)' },
                { key: 'githubLink', label: 'Repo Reference (URL)' },
                { key: 'liveLink', label: 'Live Deploy (URL)' }
            ], async (data) => {
                const res = await fetch(`${API_BASE}/admin/portfolio/projects`, {
                    method: 'POST',
                    headers: { 'Authorization': `Bearer ${token}`, 'Content-Type': 'application/json' },
                    body: JSON.stringify({ ...data, tags: data.tags.split(',').map(s => s.trim()) })
                });
                if (res.ok) {
                    const result = await res.json();
                    currentPortfolio.projects = result.projects;
                    renderProjects();
                    showToast('PROJECT REGISTERED');
                }
            });
        }

        function editProject(id) {
            const p = currentPortfolio.projects.find(x => x._id === id);
            openModal('Modify Project Parameters', [
                { key: 'title', label: 'Component Title', value: p.title },
                { key: 'description', label: 'Technical Spec', type: 'textarea', value: p.description },
                { key: 'tags', label: 'Tech Stack', value: (p.tags || []).join(', ') },
                { key: 'githubLink', label: 'Repo Reference', value: p.githubLink || '' },
                { key: 'liveLink', label: 'Live Deploy', value: p.liveLink || '' }
            ], async (data) => {
                const res = await fetch(`${API_BASE}/admin/portfolio/projects/${id}`, {
                    method: 'PUT',
                    headers: { 'Authorization': `Bearer ${token}`, 'Content-Type': 'application/json' },
                    body: JSON.stringify({ ...data, tags: data.tags.split(',').map(s => s.trim()) })
                });
                if (res.ok) {
                    const result = await res.json();
                    const idx = currentPortfolio.projects.findIndex(x => x._id === id);
                    currentPortfolio.projects[idx] = { ...currentPortfolio.projects[idx], ...data, tags: data.tags.split(',').map(s => s.trim()) };
                    renderProjects();
                    showToast('PROJECT UPDATED');
                }
            });
        }

        function openCertModal() {
            openModal('Add Authorization Record', [
                { key: 'title', label: 'Credential Name' },
                { key: 'issuer', label: 'Issuing Authority' },
                { key: 'date', label: 'Validity Period' },
                { key: 'link', label: 'Verification Node (URL)' }
            ], async (data) => {
                const res = await fetch(`${API_BASE}/admin/portfolio/certificates`, {
                    method: 'POST',
                    headers: { 'Authorization': `Bearer ${token}`, 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });
                if (res.ok) {
                    const result = await res.json();
                    currentPortfolio.certificates = result.certificates;
                    renderCertificates();
                    showToast('AUTH RECORD ADDED');
                }
            });
        }

        function editCert(id) {
            const c = currentPortfolio.certificates.find(x => x._id === id);
            openModal('Adjust Auth Record', [
                { key: 'title', label: 'Credential Name', value: c.title },
                { key: 'issuer', label: 'Issuing Authority', value: c.issuer },
                { key: 'date', label: 'Validity Period', value: c.date },
                { key: 'link', label: 'Verification Node', value: c.link || '' }
            ], async (data) => {
                const res = await fetch(`${API_BASE}/admin/portfolio/certificates/${id}`, {
                    method: 'PUT',
                    headers: { 'Authorization': `Bearer ${token}`, 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });
                if (res.ok) {
                    const idx = currentPortfolio.certificates.findIndex(x => x._id === id);
                    currentPortfolio.certificates[idx] = { ...currentPortfolio.certificates[idx], ...data };
                    renderCertificates();
                    showToast('AUTH RECORD UPDATED');
                }
            });
        }

        function openAchievementModal() {
            openModal('Log Career Milestone', [
                { key: 'title', label: 'Event Title' },
                { key: 'date', label: 'Timestamp' },
                { key: 'detail', label: 'Milestone Intelligence', type: 'textarea' }
            ], async (data) => {
                const res = await fetch(`${API_BASE}/admin/portfolio/achievements`, {
                    method: 'POST',
                    headers: { 'Authorization': `Bearer ${token}`, 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });
                if (res.ok) {
                    const result = await res.json();
                    currentPortfolio.achievements = result.achievements;
                    renderAchievements();
                    showToast('MILESTONE RECORDED');
                }
            });
        }

        function editAchievement(id) {
            const a = currentPortfolio.achievements.find(x => x._id === id);
            openModal('Adjust Career Log', [
                { key: 'title', label: 'Event Title', value: a.title },
                { key: 'date', label: 'Timestamp', value: a.date },
                { key: 'detail', label: 'Milestone Intel', type: 'textarea', value: a.detail }
            ], async (data) => {
                const res = await fetch(`${API_BASE}/admin/portfolio/achievements/${id}`, {
                    method: 'PUT',
                    headers: { 'Authorization': `Bearer ${token}`, 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });
                if (res.ok) {
                    const idx = currentPortfolio.achievements.findIndex(x => x._id === id);
                    currentPortfolio.achievements[idx] = { ...currentPortfolio.achievements[idx], ...data };
                    renderAchievements();
                    showToast('MILESTONE UPDATED');
                }
            });
        }

        // TOAST ENGINE
        function showToast(text, type = 'success') {
            const toast = document.getElementById('toast');
            toast.textContent = text;
            toast.className = 'toast ' + (type === 'error' ? 'error' : '');
            toast.style.display = 'block';
            setTimeout(() => toast.style.display = 'none', 3500);
        }
    </script>
</body>

</html>